Terraform validate with tfsec (deprecated, use "terraform_trivy").......................Failed
- hook id: terraform_tfsec
- exit code: 1

tfsec tool was deprecated, and replaced by trivy. You can check trivy hook here:
https://github.com/antonbabenko/pre-commit-terraform/tree/master#terraform_trivy

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:106
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
  106  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:89
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   89  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:98
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   98  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Instance does not have storage encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-encrypt-instance-storage-data
      Impact Data can be read from RDS instances if compromised
  Resolution Enable encryption for RDS instances

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance
────────────────────────────────────────────────────────────────────────────────


Result #7 HIGH Subnet associates public IP address. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:39
────────────────────────────────────────────────────────────────────────────────
   35    resource "aws_subnet" "public_subnet" {
   36      vpc_id                  = aws_vpc.main.id
   37      cidr_block              = "10.0.1.0/24" # Range: 10.0.1.0 - 10.0.1.255
   38      availability_zone       = "us-east-1a"  # We pin this to AZ 'a'
   39  [   map_public_ip_on_launch = true          # Auto-assign public IP (Make it public!) (true)
   40    
   41      tags = {
   42        Name = "My-Public-Subnet"
   43      }
   44    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ip-subnet
      Impact The instance is publicly accessible
  Resolution Set the instance to not be publicly accessible

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ip-subnet/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             202.873µs
  parsing              5.267746ms
  adaptation           2.83308ms
  checks               74.266745ms
  total                82.570444ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     17
  files read           2

  results
  ──────────────────────────────────────────
  passed               6
  ignored              11
  critical             3
  high                 4
  medium               0
  low                  0

  6 passed, 11 ignored, 7 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 HIGH IAM policy document uses sensitive action 'ec2:RunInstances' on wildcarded resource '*' 
────────────────────────────────────────────────────────────────────────────────
  iam.tf:81
────────────────────────────────────────────────────────────────────────────────
   76    resource "aws_iam_role_policy" "ec2_testing_access" {
   ..  
   81  [     Version = "2012-10-17"
   ..  
   99    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-iam-no-policy-wildcards
      Impact Overly permissive policies may grant access to sensitive resources
  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/iam/no-policy-wildcards/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Table encryption is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  state_setup.tf:1-10
────────────────────────────────────────────────────────────────────────────────
    1    resource "aws_dynamodb_table" "terraform_locks" {
    2      name         = "terraform-state-locking"
    3      billing_mode = "PAY_PER_REQUEST"
    4      hash_key     = "LockID"
    5    
    6      attribute {
    7        name = "LockID"
    8        type = "S"
    9      }
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-enable-at-rest-encryption
      Impact Data can be freely read if compromised
  Resolution Enable encryption at rest for DAX Cluster

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             209.724µs
  parsing              2.838664ms
  adaptation           876.108µs
  checks               12.791271ms
  total                16.715767ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     15
  files read           5

  results
  ──────────────────────────────────────────
  passed               8
  ignored              2
  critical             0
  high                 2
  medium               0
  low                  0

  8 passed, 2 ignored, 2 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
  timings
  ──────────────────────────────────────────
  disk i/o             1.451393ms
  parsing              110.659µs
  adaptation           158.939µs
  checks               10.756376ms
  total                12.477367ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     0
  files read           1

  results
  ──────────────────────────────────────────
  passed               0
  ignored              0
  critical             0
  high                 0
  medium               0
  low                  0


No problems detected!


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:61
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   61  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:10-18
────────────────────────────────────────────────────────────────────────────────
   10    resource "aws_s3_bucket_server_side_encryption_configuration" "state_encryption" {
   11      bucket = aws_s3_bucket.terraform_state_bucket.id
   12    
   13      rule {
   14        apply_server_side_encryption_by_default {
   15          sse_algorithm = "AES256"
   16        }
   17      }
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Table encryption is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:38-47
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_dynamodb_table" "terraform_locks" {
   39      name         = "terraform-locks"
   40      billing_mode = "PAY_PER_REQUEST"
   41      hash_key     = "LockID"
   42    
   43      attribute {
   44        name = "LockID"
   45        type = "S"
   46      }
   47    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-enable-at-rest-encryption
      Impact Data can be freely read if compromised
  Resolution Enable encryption at rest for DAX Cluster

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:24-34
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:24-34
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             276.351µs
  parsing              5.541045ms
  adaptation           367.827µs
  checks               7.850338ms
  total                14.035561ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     29
  files read           8

  results
  ──────────────────────────────────────────
  passed               9
  ignored              9
  critical             1
  high                 4
  medium               0
  low                  0

  9 passed, 9 ignored, 5 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:61
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   61  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:24-34
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:24-34
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             114.247µs
  parsing              1.252521ms
  adaptation           243.025µs
  checks               8.343986ms
  total                9.953779ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     13
  files read           3

  results
  ──────────────────────────────────────────
  passed               3
  ignored              4
  critical             1
  high                 2
  medium               0
  low                  0

  3 passed, 4 ignored, 3 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
  timings
  ──────────────────────────────────────────
  disk i/o             105.362µs
  parsing              936.186µs
  adaptation           220.855µs
  checks               7.949071ms
  total                9.211474ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     9
  files read           3

  results
  ──────────────────────────────────────────
  passed               6
  ignored              4
  critical             0
  high                 0
  medium               0
  low                  0


No problems detected!


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 HIGH No public access block so not blocking public acls 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-block-public-acls
      Impact PUT calls with public ACLs specified can make objects public
  Resolution Enable blocking any PUT calls with a public ACL specified

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH No public access block so not blocking public policies 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-block-public-policy
      Impact Users could put a policy that allows public access
  Resolution Prevent policies that allow public access being PUT

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Bucket does not have encryption enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-encryption
      Impact The bucket objects could be read if compromised
  Resolution Configure bucket encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH No public access block so not ignoring public acls 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-ignore-public-acls
      Impact PUT calls with public ACLs specified can make objects public
  Resolution Enable ignoring the application of public ACLs in PUT calls

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH No public access block so not restricting public buckets 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-no-public-buckets
      Impact Public buckets can be accessed by anyone
  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets¡
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             119.416µs
  parsing              825.811µs
  adaptation           317.38µs
  checks               27.691112ms
  total                28.953719ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     5
  files read           2

  results
  ──────────────────────────────────────────
  passed               1
  ignored              3
  critical             0
  high                 6
  medium               0
  low                  0

  1 passed, 3 ignored, 6 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:79
────────────────────────────────────────────────────────────────────────────────
   71    resource "aws_security_group" "allow_web" {
   72      name        = "allow_web_traffic"
   73      description = "Allow inbound web traffic"
   74    
   75      ingress {
   76        from_port   = 80
   77        to_port     = 80
   78        protocol    = "tcp"
   79  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:82-89
────────────────────────────────────────────────────────────────────────────────
   82    resource "aws_instance" "web_server" {
   83      ami           = data.aws_ami.selected.id
   84      instance_type = "t3.micro"
   85    
   86      tags = {
   87        Name = "TestServer-${var.os_type}"
   88      }
   89    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:82-89
────────────────────────────────────────────────────────────────────────────────
   82    resource "aws_instance" "web_server" {
   83      ami           = data.aws_ami.selected.id
   84      instance_type = "t3.micro"
   85    
   86      tags = {
   87        Name = "TestServer-${var.os_type}"
   88      }
   89    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             85.625µs
  parsing              2.408004ms
  adaptation           390.604µs
  checks               19.822642ms
  total                22.706875ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     6
  files read           1

  results
  ──────────────────────────────────────────
  passed               1
  ignored              2
  critical             1
  high                 2
  medium               0
  low                  0

  1 passed, 2 ignored, 3 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:80
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   80  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:89
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   89  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:97
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   97  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:26-66
────────────────────────────────────────────────────────────────────────────────
   26  ┌ resource "aws_instance" "first_instance" {
   27  │   ami           = data.aws_ami.amazon_linux.id
   28  │   instance_type = var.instance_type
   29  │   key_name      = var.key_name
   30  │ 
   31  │   metadata_options {
   32  │     http_tokens = "required"
   33  │   }
   34  └ 
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             121.572µs
  parsing              1.924868ms
  adaptation           219.318µs
  checks               29.187866ms
  total                31.453624ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     16
  files read           3

  results
  ──────────────────────────────────────────
  passed               3
  ignored              5
  critical             3
  high                 1
  medium               0
  low                  0

  3 passed, 5 ignored, 4 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:47
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   47  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:63
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   63  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Topic does not have encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  dashboard.tf:42-44
────────────────────────────────────────────────────────────────────────────────
   42    resource "aws_sns_topic" "alerts" {
   43      name = "infrastructure-alerts"
   44    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-sns-enable-topic-encryption
      Impact The SNS topic messages could be read if compromised
  Resolution Turn on SNS Topic encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/sns/enable-topic-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:83-94
────────────────────────────────────────────────────────────────────────────────
   83  ┌ resource "aws_instance" "web_server" {
   84  │   ami           = data.aws_ami.golden_nginx.id
   85  │   instance_type = var.instance_type
   86  │   # Attach the IAM Instance Profile
   87  │   iam_instance_profile = aws_iam_instance_profile.ec2_profile.name
   88  │ 
   89  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
   90  │ 
   91  └   tags = {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:83-94
────────────────────────────────────────────────────────────────────────────────
   83  ┌ resource "aws_instance" "web_server" {
   84  │   ami           = data.aws_ami.golden_nginx.id
   85  │   instance_type = var.instance_type
   86  │   # Attach the IAM Instance Profile
   87  │   iam_instance_profile = aws_iam_instance_profile.ec2_profile.name
   88  │ 
   89  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
   90  │ 
   91  └   tags = {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             428.865µs
  parsing              78.509707ms
  adaptation           369.307µs
  checks               53.07363ms
  total                132.381509ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     17
  files read           4

  results
  ──────────────────────────────────────────
  passed               3
  ignored              4
  critical             2
  high                 3
  medium               0
  low                  0

  3 passed, 4 ignored, 5 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 HIGH Distribution allows unencrypted communications. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:117-119
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
   80    resource "aws_cloudfront_distribution" "s3_distribution" {
   ..  
  117  ┌   viewer_certificate {
  118  │     cloudfront_default_certificate = true
  119  └   }
  ...  
  130    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Bucket does not have encryption enabled 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:2-10
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-encryption
      Impact The bucket objects could be read if compromised
  Resolution Configure bucket encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:2-10
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Distribution does not utilise a WAF. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:80-130
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
   80  ┌ resource "aws_cloudfront_distribution" "s3_distribution" {
   81  │   origin {
   82  │     domain_name              = aws_s3_bucket.static_website_bucket.bucket_regional_domain_name
   83  │     origin_access_control_id = aws_cloudfront_origin_access_control.oac.id
   84  │     origin_id                = local.origin_id
   85  │   }
   86  │ 
   87  │   enabled             = true
   88  └   is_ipv6_enabled     = true
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-enable-waf
      Impact Complex web application attacks can more easily be performed without a WAF
  Resolution Enable WAF for the CloudFront distribution

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/enable-waf/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             418.985µs
  parsing              12.77625ms
  adaptation           1.139559ms
  checks               18.690569ms
  total                33.025363ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     23
  files read           8

  results
  ──────────────────────────────────────────
  passed               6
  ignored              4
  critical             0
  high                 4
  medium               0
  low                  0

  6 passed, 4 ignored, 4 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 HIGH Distribution allows unencrypted communications. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:117-119
────────────────────────────────────────────────────────────────────────────────
   80    resource "aws_cloudfront_distribution" "s3_distribution" {
   ..  
  117  ┌   viewer_certificate {
  118  │     cloudfront_default_certificate = true
  119  └   }
  ...  
  130    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Bucket does not have encryption enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:2-10
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-encryption
      Impact The bucket objects could be read if compromised
  Resolution Configure bucket encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:2-10
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Distribution does not utilise a WAF. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:80-130
────────────────────────────────────────────────────────────────────────────────
   80  ┌ resource "aws_cloudfront_distribution" "s3_distribution" {
   81  │   origin {
   82  │     domain_name              = aws_s3_bucket.static_website_bucket.bucket_regional_domain_name
   83  │     origin_access_control_id = aws_cloudfront_origin_access_control.oac.id
   84  │     origin_id                = local.origin_id
   85  │   }
   86  │ 
   87  │   enabled             = true
   88  └   is_ipv6_enabled     = true
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-enable-waf
      Impact Complex web application attacks can more easily be performed without a WAF
  Resolution Enable WAF for the CloudFront distribution

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/enable-waf/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             224.217µs
  parsing              4.296215ms
  adaptation           1.818957ms
  checks               37.903527ms
  total                44.242916ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     15
  files read           4

  results
  ──────────────────────────────────────────
  passed               6
  ignored              4
  critical             0
  high                 4
  medium               0
  low                  0

  6 passed, 4 ignored, 4 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?
  timings
  ──────────────────────────────────────────
  disk i/o             3.132559ms
  parsing              520.042807ms
  adaptation           193.391µs
  checks               13.03643ms
  total                536.405187ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     433
  files read           9

  results
  ──────────────────────────────────────────
  passed               0
  ignored              5
  critical             0
  high                 0
  medium               0
  low                  0


No problems detected!


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:24
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   24  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:31
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   31  [     cidr_blocks = ["0.0.0.0/0"] # In production, use your own IP here!
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:38
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   38  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:43-51
────────────────────────────────────────────────────────────────────────────────
   43    resource "aws_instance" "web_server" {
   44      ami                    = "ami-07eefb25c0129be09" # PASTE YOUR NEW AMI ID HERE
   45      instance_type          = "t3.micro"
   46      vpc_security_group_ids = [aws_security_group.web_sg.id]
   47    
   48      tags = {
   49        Name = "Deployed-With-Terraform"
   50      }
   51    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:43-51
────────────────────────────────────────────────────────────────────────────────
   43    resource "aws_instance" "web_server" {
   44      ami                    = "ami-07eefb25c0129be09" # PASTE YOUR NEW AMI ID HERE
   45      instance_type          = "t3.micro"
   46      vpc_security_group_ids = [aws_security_group.web_sg.id]
   47    
   48      tags = {
   49        Name = "Deployed-With-Terraform"
   50      }
   51    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             42.181µs
  parsing              632.219µs
  adaptation           177.563µs
  checks               8.489595ms
  total                9.341558ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     5
  files read           1

  results
  ──────────────────────────────────────────
  passed               1
  ignored              4
  critical             3
  high                 2
  medium               0
  low                  0

  1 passed, 4 ignored, 5 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:106
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
  106  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:89
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   89  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:98
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   98  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Instance does not have storage encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-encrypt-instance-storage-data
      Impact Data can be read from RDS instances if compromised
  Resolution Enable encryption for RDS instances

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance
────────────────────────────────────────────────────────────────────────────────


Result #7 HIGH Subnet associates public IP address. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:39
────────────────────────────────────────────────────────────────────────────────
   35    resource "aws_subnet" "public_subnet" {
   36      vpc_id                  = aws_vpc.main.id
   37      cidr_block              = "10.0.1.0/24" # Range: 10.0.1.0 - 10.0.1.255
   38      availability_zone       = "us-east-1a"  # We pin this to AZ 'a'
   39  [   map_public_ip_on_launch = true          # Auto-assign public IP (Make it public!) (true)
   40    
   41      tags = {
   42        Name = "My-Public-Subnet"
   43      }
   44    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ip-subnet
      Impact The instance is publicly accessible
  Resolution Set the instance to not be publicly accessible

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ip-subnet/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             156.624µs
  parsing              2.842061ms
  adaptation           262.064µs
  checks               26.323718ms
  total                29.584467ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     17
  files read           2

  results
  ──────────────────────────────────────────
  passed               6
  ignored              11
  critical             3
  high                 4
  medium               0
  low                  0

  6 passed, 11 ignored, 7 potential problem(s) detected.



nikky-techies@HP-EliteBook-820-G3:~/devops-learning-journey$ pre-commit run --all-files
Terraform fmt...........................................................................Passed
Terraform validate......................................................................Passed
Terraform validate with tfsec (deprecated, use "terraform_trivy").......................Failed
- hook id: terraform_tfsec
- exit code: 1
- files were modified by this hook

tfsec tool was deprecated, and replaced by trivy. You can check trivy hook here:
https://github.com/antonbabenko/pre-commit-terraform/tree/master#terraform_trivy

======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:106
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
  106  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:89
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   89  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:98
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   98  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Instance does not have storage encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-encrypt-instance-storage-data
      Impact Data can be read from RDS instances if compromised
  Resolution Enable encryption for RDS instances

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance
────────────────────────────────────────────────────────────────────────────────


Result #7 HIGH Subnet associates public IP address. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:39
────────────────────────────────────────────────────────────────────────────────
   35    resource "aws_subnet" "public_subnet" {
   36      vpc_id                  = aws_vpc.main.id
   37      cidr_block              = "10.0.1.0/24" # Range: 10.0.1.0 - 10.0.1.255
   38      availability_zone       = "us-east-1a"  # We pin this to AZ 'a'
   39  [   map_public_ip_on_launch = true          # Auto-assign public IP (Make it public!) (true)
   40    
   41      tags = {
   42        Name = "My-Public-Subnet"
   43      }
   44    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ip-subnet
      Impact The instance is publicly accessible
  Resolution Set the instance to not be publicly accessible

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ip-subnet/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch
────────────────────────────────────────────────────────────────────────────────


Result #8 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:16-22
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_vpc" "main" {
   17      cidr_block = "10.0.0.0/16" # This gives you 65,536 IP addresses
   18    
   19      tags = {
   20        Name = "My-DevOps-Project-VPC"
   21      }
   22    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


Result #9 MEDIUM Instance has very low backup retention period. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-specify-backup-retention
      Impact Potential loss of data and short opportunity for recovery
  Resolution Explicitly set the retention period to greater than the default

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/specify-backup-retention/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period
────────────────────────────────────────────────────────────────────────────────


Result #10 MEDIUM Instance does not have IAM Authentication enabled 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
  Rego Package builtin.aws.rds.aws0176
     Rego Rule deny
────────────────────────────────────────────────────────────────────────────────


Result #11 MEDIUM Instance does not have Deletion Protection enabled 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
  Rego Package builtin.aws.rds.aws0177
     Rego Rule deny
────────────────────────────────────────────────────────────────────────────────


Result #12 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:102-107
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
  102  ┌   egress {
  103  │     from_port   = 0
  104  │     to_port     = 0
  105  │     protocol    = "-1"
  106  │     cidr_blocks = ["0.0.0.0/0"]
  107  └   }
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #13 LOW Instance does not have performance insights enabled. 
────────────────────────────────────────────────────────────────────────────────
  aws-terraform-project/main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-enable-performance-insights
      Impact Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
  Resolution Enable performance insights

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             110.804µs
  parsing              3.088044ms
  adaptation           308.666µs
  checks               25.453538ms
  total                28.961052ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     17
  files read           2

  results
  ──────────────────────────────────────────
  passed               11
  ignored              0
  critical             3
  high                 4
  medium               4
  low                  2

  11 passed, 13 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 HIGH IAM policy document uses sensitive action 'ec2:RunInstances' on wildcarded resource '*' 
────────────────────────────────────────────────────────────────────────────────
  iam.tf:81
────────────────────────────────────────────────────────────────────────────────
   76    resource "aws_iam_role_policy" "ec2_testing_access" {
   ..  
   81  [     Version = "2012-10-17"
   ..  
   99    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-iam-no-policy-wildcards
      Impact Overly permissive policies may grant access to sensitive resources
  Resolution Specify the exact permissions required, and to which resources they should apply instead of using wildcards.

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/iam/no-policy-wildcards/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Table encryption is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  state_setup.tf:1-10
────────────────────────────────────────────────────────────────────────────────
    1    resource "aws_dynamodb_table" "terraform_locks" {
    2      name         = "terraform-state-locking"
    3      billing_mode = "PAY_PER_REQUEST"
    4      hash_key     = "LockID"
    5    
    6      attribute {
    7        name = "LockID"
    8        type = "S"
    9      }
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-enable-at-rest-encryption
      Impact Data can be freely read if compromised
  Resolution Enable encryption at rest for DAX Cluster

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 MEDIUM Point-in-time recovery is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  state_setup.tf:1-10
────────────────────────────────────────────────────────────────────────────────
    1    resource "aws_dynamodb_table" "terraform_locks" {
    2      name         = "terraform-state-locking"
    3      billing_mode = "PAY_PER_REQUEST"
    4      hash_key     = "LockID"
    5    
    6      attribute {
    7        name = "LockID"
    8        type = "S"
    9      }
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-enable-recovery
      Impact Accidental or malicious writes and deletes can't be rolled back
  Resolution Enable point in time recovery

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/enable-recovery/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery
────────────────────────────────────────────────────────────────────────────────


Result #4 LOW Table encryption does not use a customer-managed KMS key. 
────────────────────────────────────────────────────────────────────────────────
  state_setup.tf:1-10
────────────────────────────────────────────────────────────────────────────────
    1    resource "aws_dynamodb_table" "terraform_locks" {
    2      name         = "terraform-state-locking"
    3      billing_mode = "PAY_PER_REQUEST"
    4      hash_key     = "LockID"
    5    
    6      attribute {
    7        name = "LockID"
    8        type = "S"
    9      }
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-table-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable server side encryption with a customer managed key

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/table-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             189.886µs
  parsing              2.460721ms
  adaptation           895.288µs
  checks               7.597908ms
  total                11.143803ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     15
  files read           5

  results
  ──────────────────────────────────────────
  passed               8
  ignored              0
  critical             0
  high                 2
  medium               1
  low                  1

  8 passed, 4 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
  timings
  ──────────────────────────────────────────
  disk i/o             2.904544ms
  parsing              133.794µs
  adaptation           192.539µs
  checks               49.521911ms
  total                52.752788ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     0
  files read           1

  results
  ──────────────────────────────────────────
  passed               0
  ignored              0
  critical             0
  high                 0
  medium               0
  low                  0


No problems detected!


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:61
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   61  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:10-18
────────────────────────────────────────────────────────────────────────────────
   10    resource "aws_s3_bucket_server_side_encryption_configuration" "state_encryption" {
   11      bucket = aws_s3_bucket.terraform_state_bucket.id
   12    
   13      rule {
   14        apply_server_side_encryption_by_default {
   15          sse_algorithm = "AES256"
   16        }
   17      }
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Table encryption is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:38-47
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_dynamodb_table" "terraform_locks" {
   39      name         = "terraform-locks"
   40      billing_mode = "PAY_PER_REQUEST"
   41      hash_key     = "LockID"
   42    
   43      attribute {
   44        name = "LockID"
   45        type = "S"
   46      }
   47    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-enable-at-rest-encryption
      Impact Data can be freely read if compromised
  Resolution Enable encryption at rest for DAX Cluster

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dax_cluster#server_side_encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:24-34
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:24-34
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 MEDIUM Bucket does not have logging enabled 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:2-8
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "terraform_state_bucket" {
    3      bucket = "nikky-techies-terraform-state-bucket-21"
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-logging
      Impact There is no way to determine the access to this bucket
  Resolution Add a logging block to the resource to enable access logging

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket
────────────────────────────────────────────────────────────────────────────────


Result #7 MEDIUM Point-in-time recovery is not enabled. 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:38-47
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_dynamodb_table" "terraform_locks" {
   39      name         = "terraform-locks"
   40      billing_mode = "PAY_PER_REQUEST"
   41      hash_key     = "LockID"
   42    
   43      attribute {
   44        name = "LockID"
   45        type = "S"
   46      }
   47    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-enable-recovery
      Impact Accidental or malicious writes and deletes can't be rolled back
  Resolution Enable point in time recovery

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/enable-recovery/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#point_in_time_recovery
────────────────────────────────────────────────────────────────────────────────


Result #8 LOW Table encryption does not use a customer-managed KMS key. 
────────────────────────────────────────────────────────────────────────────────
  backend-resources.tf:38-47
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_dynamodb_table" "terraform_locks" {
   39      name         = "terraform-locks"
   40      billing_mode = "PAY_PER_REQUEST"
   41      hash_key     = "LockID"
   42    
   43      attribute {
   44        name = "LockID"
   45        type = "S"
   46      }
   47    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-dynamodb-table-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable server side encryption with a customer managed key

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/dynamodb/table-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/dynamodb_table#server_side_encryption
────────────────────────────────────────────────────────────────────────────────


Result #9 LOW Security group explicitly uses the default description. 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:39
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   39  [   description = "Managed by Terraform" ("Managed by Terraform")
   ..  
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #10 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  modules/module-1/main.tf:57-62
   via main.tf:1-7 (module.my_ec2)
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   57  ┌   egress {
   58  │     from_port   = 0
   59  │     to_port     = 0
   60  │     protocol    = "-1"
   61  │     cidr_blocks = ["0.0.0.0/0"]
   62  └   }
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             584.46µs
  parsing              8.996627ms
  adaptation           604.437µs
  checks               16.604855ms
  total                26.790379ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     29
  files read           8

  results
  ──────────────────────────────────────────
  passed               13
  ignored              0
  critical             1
  high                 4
  medium               2
  low                  3

  13 passed, 10 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:61
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   61  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:24-34
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:24-34
────────────────────────────────────────────────────────────────────────────────
   24  ┌ resource "aws_instance" "this" {
   25  │   ami           = data.aws_ami.amazon_linux.id
   26  │   instance_type = var.instance_type
   27  │   key_name      = aws_key_pair.this.key_name
   28  │ 
   29  │   vpc_security_group_ids = [aws_security_group.main.id]
   30  │ 
   31  │   tags = {
   32  └     Name = var.instance_name
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #4 LOW Security group explicitly uses the default description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:39
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   39  [   description = "Managed by Terraform" ("Managed by Terraform")
   ..  
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #5 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:57-62
────────────────────────────────────────────────────────────────────────────────
   37    resource "aws_security_group" "main" {
   ..  
   57  ┌   egress {
   58  │     from_port   = 0
   59  │     to_port     = 0
   60  │     protocol    = "-1"
   61  │     cidr_blocks = ["0.0.0.0/0"]
   62  └   }
   63    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             127.415µs
  parsing              1.401286ms
  adaptation           274.988µs
  checks               7.8606ms
  total                9.664289ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     13
  files read           3

  results
  ──────────────────────────────────────────
  passed               5
  ignored              0
  critical             1
  high                 2
  medium               0
  low                  2

  5 passed, 5 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
  timings
  ──────────────────────────────────────────
  disk i/o             761.351µs
  parsing              870.236µs
  adaptation           248.667µs
  checks               24.462587ms
  total                26.342841ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     9
  files read           3

  results
  ──────────────────────────────────────────
  passed               8
  ignored              2
  critical             0
  high                 0
  medium               0
  low                  0


No problems detected!


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 HIGH No public access block so not blocking public acls 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-block-public-acls
      Impact PUT calls with public ACLs specified can make objects public
  Resolution Enable blocking any PUT calls with a public ACL specified

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-acls/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH No public access block so not blocking public policies 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-block-public-policy
      Impact Users could put a policy that allows public access
  Resolution Prevent policies that allow public access being PUT

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/block-public-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Bucket does not have encryption enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-encryption
      Impact The bucket objects could be read if compromised
  Resolution Configure bucket encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH No public access block so not ignoring public acls 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-ignore-public-acls
      Impact PUT calls with public ACLs specified can make objects public
  Resolution Enable ignoring the application of public ACLs in PUT calls

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/ignore-public-acls/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH No public access block so not restricting public buckets 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-no-public-buckets
      Impact Public buckets can be accessed by anyone
  Resolution Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/no-public-buckets/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_buckets¡
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #7 MEDIUM Bucket does not have logging enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-logging
      Impact There is no way to determine the access to this bucket
  Resolution Add a logging block to the resource to enable access logging

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket
────────────────────────────────────────────────────────────────────────────────


Result #8 MEDIUM Bucket does not have versioning enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-versioning
      Impact Deleted or modified data would not be recoverable
  Resolution Enable versioning to protect against accidental/malicious removal or modification

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning
────────────────────────────────────────────────────────────────────────────────


Result #9 LOW Bucket does not have a corresponding public access block. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:15-18
────────────────────────────────────────────────────────────────────────────────
   15    resource "aws_s3_bucket" "my_bucket" {
   16      bucket = "nikky-techies-${terraform.workspace}-bucket-21"
   17    
   18    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-specify-public-access-block
      Impact Public access policies may be applied to sensitive data buckets
  Resolution Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/specify-public-access-block/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             95.371µs
  parsing              769.304µs
  adaptation           278.575µs
  checks               22.511423ms
  total                23.654673ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     5
  files read           2

  results
  ──────────────────────────────────────────
  passed               1
  ignored              0
  critical             0
  high                 6
  medium               2
  low                  1

  1 passed, 9 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:79
────────────────────────────────────────────────────────────────────────────────
   71    resource "aws_security_group" "allow_web" {
   72      name        = "allow_web_traffic"
   73      description = "Allow inbound web traffic"
   74    
   75      ingress {
   76        from_port   = 80
   77        to_port     = 80
   78        protocol    = "tcp"
   79  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:82-89
────────────────────────────────────────────────────────────────────────────────
   82    resource "aws_instance" "web_server" {
   83      ami           = data.aws_ami.selected.id
   84      instance_type = "t3.micro"
   85    
   86      tags = {
   87        Name = "TestServer-${var.os_type}"
   88      }
   89    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:82-89
────────────────────────────────────────────────────────────────────────────────
   82    resource "aws_instance" "web_server" {
   83      ami           = data.aws_ami.selected.id
   84      instance_type = "t3.micro"
   85    
   86      tags = {
   87        Name = "TestServer-${var.os_type}"
   88      }
   89    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #4 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:75-80
────────────────────────────────────────────────────────────────────────────────
   71    resource "aws_security_group" "allow_web" {
   72      name        = "allow_web_traffic"
   73      description = "Allow inbound web traffic"
   74    
   75  ┌   ingress {
   76  │     from_port   = 80
   77  │     to_port     = 80
   78  │     protocol    = "tcp"
   79  └     cidr_blocks = ["0.0.0.0/0"]
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             69.839µs
  parsing              1.460793ms
  adaptation           242.153µs
  checks               40.160374ms
  total                41.933159ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     6
  files read           1

  results
  ──────────────────────────────────────────
  passed               2
  ignored              0
  critical             1
  high                 2
  medium               0
  low                  1

  2 passed, 4 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:80
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   80  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:89
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   89  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:97
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   97  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:26-66
────────────────────────────────────────────────────────────────────────────────
   26  ┌ resource "aws_instance" "first_instance" {
   27  │   ami           = data.aws_ami.amazon_linux.id
   28  │   instance_type = var.instance_type
   29  │   key_name      = var.key_name
   30  │ 
   31  │   metadata_options {
   32  │     http_tokens = "required"
   33  │   }
   34  └ 
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #5 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  main.tf:106-112
────────────────────────────────────────────────────────────────────────────────
  106    resource "aws_vpc" "practice" {
  107      cidr_block = "10.0.0.0/16" # This gives you 65,536 IP addresses
  108    
  109      tags = {
  110        Name = "practice-VPC"
  111      }
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


Result #6 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:93-98
────────────────────────────────────────────────────────────────────────────────
   69    resource "aws_security_group" "allow_tls" {
   ..  
   93  ┌   egress {
   94  │     from_port   = 0
   95  │     to_port     = 0
   96  │     protocol    = "-1"
   97  │     cidr_blocks = ["0.0.0.0/0"]
   98  └   }
  ...  
  103    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             169.325µs
  parsing              2.483649ms
  adaptation           354.567µs
  checks               32.90337ms
  total                35.910911ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     16
  files read           3

  results
  ──────────────────────────────────────────
  passed               6
  ignored              0
  critical             3
  high                 1
  medium               1
  low                  1

  6 passed, 6 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:47
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   47  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:63
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   63  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Topic does not have encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  dashboard.tf:42-44
────────────────────────────────────────────────────────────────────────────────
   42    resource "aws_sns_topic" "alerts" {
   43      name = "infrastructure-alerts"
   44    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-sns-enable-topic-encryption
      Impact The SNS topic messages could be read if compromised
  Resolution Turn on SNS Topic encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/sns/enable-topic-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic#example-with-server-side-encryption-sse
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:83-94
────────────────────────────────────────────────────────────────────────────────
   83  ┌ resource "aws_instance" "web_server" {
   84  │   ami           = data.aws_ami.golden_nginx.id
   85  │   instance_type = var.instance_type
   86  │   # Attach the IAM Instance Profile
   87  │   iam_instance_profile = aws_iam_instance_profile.ec2_profile.name
   88  │ 
   89  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
   90  │ 
   91  └   tags = {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:83-94
────────────────────────────────────────────────────────────────────────────────
   83  ┌ resource "aws_instance" "web_server" {
   84  │   ami           = data.aws_ami.golden_nginx.id
   85  │   instance_type = var.instance_type
   86  │   # Attach the IAM Instance Profile
   87  │   iam_instance_profile = aws_iam_instance_profile.ec2_profile.name
   88  │ 
   89  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
   90  │ 
   91  └   tags = {
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:43-48
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   43  ┌   ingress {
   44  │     from_port   = 80
   45  │     to_port     = 80
   46  │     protocol    = "tcp"
   47  │     cidr_blocks = ["0.0.0.0/0"]
   48  └   }
   ..  
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #7 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:51-56
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   51  ┌   ingress {
   52  │     from_port   = 22
   53  │     to_port     = 22
   54  │     protocol    = "tcp"
   55  │     cidr_blocks = [var.my_ip]
   56  └   }
   ..  
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #8 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:59-64
────────────────────────────────────────────────────────────────────────────────
   38    resource "aws_security_group" "web_sg" {
   ..  
   59  ┌   egress {
   60  │     from_port   = 0
   61  │     to_port     = 0
   62  │     protocol    = "-1"
   63  │     cidr_blocks = ["0.0.0.0/0"]
   64  └   }
   65    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             3.672406ms
  parsing              23.66202ms
  adaptation           378.435µs
  checks               11.680047ms
  total                39.392908ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     17
  files read           4

  results
  ──────────────────────────────────────────
  passed               4
  ignored              0
  critical             2
  high                 3
  medium               0
  low                  3

  4 passed, 8 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 HIGH Distribution allows unencrypted communications. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:117-119
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
   80    resource "aws_cloudfront_distribution" "s3_distribution" {
   ..  
  117  ┌   viewer_certificate {
  118  │     cloudfront_default_certificate = true
  119  └   }
  ...  
  130    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Bucket does not have encryption enabled 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:2-10
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-encryption
      Impact The bucket objects could be read if compromised
  Resolution Configure bucket encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:2-10
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Distribution does not utilise a WAF. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:80-130
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
   80  ┌ resource "aws_cloudfront_distribution" "s3_distribution" {
   81  │   origin {
   82  │     domain_name              = aws_s3_bucket.static_website_bucket.bucket_regional_domain_name
   83  │     origin_access_control_id = aws_cloudfront_origin_access_control.oac.id
   84  │     origin_id                = local.origin_id
   85  │   }
   86  │ 
   87  │   enabled             = true
   88  └   is_ipv6_enabled     = true
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-enable-waf
      Impact Complex web application attacks can more easily be performed without a WAF
  Resolution Enable WAF for the CloudFront distribution

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/enable-waf/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id
────────────────────────────────────────────────────────────────────────────────


Result #5 MEDIUM Bucket does not have logging enabled 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:2-10
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-logging
      Impact There is no way to determine the access to this bucket
  Resolution Add a logging block to the resource to enable access logging

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket
────────────────────────────────────────────────────────────────────────────────


Result #6 MEDIUM Bucket does not have versioning enabled 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:2-10
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-versioning
      Impact Deleted or modified data would not be recoverable
  Resolution Enable versioning to protect against accidental/malicious removal or modification

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning
────────────────────────────────────────────────────────────────────────────────


Result #7 MEDIUM Distribution does not have logging enabled. 
────────────────────────────────────────────────────────────────────────────────
  modules/static-website/main.tf:80-130
   via main.tf:1-7 (module.my_static_website)
────────────────────────────────────────────────────────────────────────────────
   80  ┌ resource "aws_cloudfront_distribution" "s3_distribution" {
   81  │   origin {
   82  │     domain_name              = aws_s3_bucket.static_website_bucket.bucket_regional_domain_name
   83  │     origin_access_control_id = aws_cloudfront_origin_access_control.oac.id
   84  │     origin_id                = local.origin_id
   85  │   }
   86  │ 
   87  │   enabled             = true
   88  └   is_ipv6_enabled     = true
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-enable-logging
      Impact Logging provides vital information about access and usage
  Resolution Enable logging for CloudFront distributions

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/enable-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             3.879601ms
  parsing              8.417687ms
  adaptation           970.639µs
  checks               27.129757ms
  total                40.397684ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     23
  files read           8

  results
  ──────────────────────────────────────────
  passed               7
  ignored              0
  critical             0
  high                 4
  medium               3
  low                  0

  7 passed, 7 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 HIGH Distribution allows unencrypted communications. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:117-119
────────────────────────────────────────────────────────────────────────────────
   80    resource "aws_cloudfront_distribution" "s3_distribution" {
   ..  
  117  ┌   viewer_certificate {
  118  │     cloudfront_default_certificate = true
  119  └   }
  ...  
  130    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#minimum_protocol_version
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Bucket does not have encryption enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:2-10
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-encryption
      Impact The bucket objects could be read if compromised
  Resolution Configure bucket encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Bucket does not encrypt data with a customer managed key. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:2-10
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-encryption-customer-key
      Impact Using AWS managed keys does not allow for fine grained control
  Resolution Enable encryption using customer managed keys

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/encryption-customer-key/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Distribution does not utilise a WAF. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:80-130
────────────────────────────────────────────────────────────────────────────────
   80  ┌ resource "aws_cloudfront_distribution" "s3_distribution" {
   81  │   origin {
   82  │     domain_name              = aws_s3_bucket.static_website_bucket.bucket_regional_domain_name
   83  │     origin_access_control_id = aws_cloudfront_origin_access_control.oac.id
   84  │     origin_id                = local.origin_id
   85  │   }
   86  │ 
   87  │   enabled             = true
   88  └   is_ipv6_enabled     = true
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-enable-waf
      Impact Complex web application attacks can more easily be performed without a WAF
  Resolution Enable WAF for the CloudFront distribution

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/enable-waf/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#web_acl_id
────────────────────────────────────────────────────────────────────────────────


Result #5 MEDIUM Bucket does not have logging enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:2-10
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-bucket-logging
      Impact There is no way to determine the access to this bucket
  Resolution Add a logging block to the resource to enable access logging

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-bucket-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket
────────────────────────────────────────────────────────────────────────────────


Result #6 MEDIUM Bucket does not have versioning enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:2-10
────────────────────────────────────────────────────────────────────────────────
    2    resource "aws_s3_bucket" "static_website_bucket" {
    3      bucket = var.bucket_name # Ensure this is globally unique
    4    
    5      lifecycle {
    6        prevent_destroy = false
    7      }
    8    
    9      tags = local.common_tags
   10    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-s3-enable-versioning
      Impact Deleted or modified data would not be recoverable
  Resolution Enable versioning to protect against accidental/malicious removal or modification

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/s3/enable-versioning/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning
────────────────────────────────────────────────────────────────────────────────


Result #7 MEDIUM Distribution does not have logging enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:80-130
────────────────────────────────────────────────────────────────────────────────
   80  ┌ resource "aws_cloudfront_distribution" "s3_distribution" {
   81  │   origin {
   82  │     domain_name              = aws_s3_bucket.static_website_bucket.bucket_regional_domain_name
   83  │     origin_access_control_id = aws_cloudfront_origin_access_control.oac.id
   84  │     origin_id                = local.origin_id
   85  │   }
   86  │ 
   87  │   enabled             = true
   88  └   is_ipv6_enabled     = true
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-cloudfront-enable-logging
      Impact Logging provides vital information about access and usage
  Resolution Enable logging for CloudFront distributions

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/cloudfront/enable-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/cloudfront_distribution#logging_config
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             308.11µs
  parsing              6.704912ms
  adaptation           1.256477ms
  checks               9.634503ms
  total                17.904002ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     15
  files read           4

  results
  ──────────────────────────────────────────
  passed               7
  ignored              0
  critical             0
  high                 4
  medium               3
  low                  0

  7 passed, 7 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  terraform-aws-modules/vpc/aws/home/nikky-techies/devops-learning-journey/03-infrastructure-as-code/projects/vpc-infrastructure/.terraform/modules/vpc/main.tf:29-52
   via main.tf:1-24 (module.vpc)
────────────────────────────────────────────────────────────────────────────────
   29  ┌ resource "aws_vpc" "this" {
   30  │   count = local.create_vpc ? 1 : 0
   31  │ 
   32  │   cidr_block          = var.use_ipam_pool ? null : var.cidr
   33  │   ipv4_ipam_pool_id   = var.ipv4_ipam_pool_id
   34  │   ipv4_netmask_length = var.ipv4_netmask_length
   35  │ 
   36  │   assign_generated_ipv6_cidr_block     = var.enable_ipv6 && !var.use_ipam_pool ? true : null
   37  └   ipv6_cidr_block                      = var.ipv6_cidr
   ..  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             7.842451ms
  parsing              667.569088ms
  adaptation           378.816µs
  checks               14.524077ms
  total                690.314432ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    2
  blocks processed     433
  files read           9

  results
  ──────────────────────────────────────────
  passed               4
  ignored              0
  critical             0
  high                 0
  medium               1
  low                  0

  4 passed, 1 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================

Result #1 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:24
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   24  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:31
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   31  [     cidr_blocks = ["0.0.0.0/0"] # In production, use your own IP here!
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:38
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   38  [     cidr_blocks = ["0.0.0.0/0"]
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:43-51
────────────────────────────────────────────────────────────────────────────────
   43    resource "aws_instance" "web_server" {
   44      ami                    = "ami-07eefb25c0129be09" # PASTE YOUR NEW AMI ID HERE
   45      instance_type          = "t3.micro"
   46      vpc_security_group_ids = [aws_security_group.web_sg.id]
   47    
   48      tags = {
   49        Name = "Deployed-With-Terraform"
   50      }
   51    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:43-51
────────────────────────────────────────────────────────────────────────────────
   43    resource "aws_instance" "web_server" {
   44      ami                    = "ami-07eefb25c0129be09" # PASTE YOUR NEW AMI ID HERE
   45      instance_type          = "t3.micro"
   46      vpc_security_group_ids = [aws_security_group.web_sg.id]
   47    
   48      tags = {
   49        Name = "Deployed-With-Terraform"
   50      }
   51    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:20-25
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   20  ┌   ingress {
   21  │     from_port   = 80
   22  │     to_port     = 80
   23  │     protocol    = "tcp"
   24  │     cidr_blocks = ["0.0.0.0/0"]
   25  └   }
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #7 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:27-32
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   27  ┌   ingress {
   28  │     from_port   = 22
   29  │     to_port     = 22
   30  │     protocol    = "tcp"
   31  │     cidr_blocks = ["0.0.0.0/0"] # In production, use your own IP here!
   32  └   }
   ..  
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #8 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:34-39
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_security_group" "web_sg" {
   ..  
   34  ┌   egress {
   35  │     from_port   = 0
   36  │     to_port     = 0
   37  │     protocol    = "-1"
   38  │     cidr_blocks = ["0.0.0.0/0"]
   39  └   }
   40    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             59.917µs
  parsing              869.76µs
  adaptation           235.861µs
  checks               8.975104ms
  total                10.140642ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     5
  files read           1

  results
  ──────────────────────────────────────────
  passed               2
  ignored              0
  critical             3
  high                 2
  medium               0
  low                  3

  2 passed, 8 potential problem(s) detected.


======================================================
tfsec is joining the Trivy family

tfsec will continue to remain available 
for the time being, although our engineering 
attention will be directed at Trivy going forward.

You can read more here: 
https://github.com/aquasecurity/tfsec/discussions/1994
======================================================
WARNING: A tfvars file was found but not automatically used. Did you mean to specify the --tfvars-file flag?

Result #1 CRITICAL Security group rule allows egress to multiple public internet addresses. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:106
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
  106  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-egress-sgr
      Impact Your port is egressing data to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-egress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:89
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   89  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #3 CRITICAL Security group rule allows ingress from public internet. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:98
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
   98  [     cidr_blocks = ["0.0.0.0/0"]
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ingress-sgr
      Impact Your port exposed to the internet
  Resolution Set a more restrictive cidr range

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ingress-sgr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule#cidr_blocks
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Instance does not require IMDS access to require a token 
────────────────────────────────────────────────────────────────────────────────
  main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enforce-http-token-imds
      Impact Instance metadata service can be interacted with freely
  Resolution Enable HTTP token requirement for IMDS

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enforce-http-token-imds/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#metadata-options
────────────────────────────────────────────────────────────────────────────────


Result #5 HIGH Root block device is not encrypted. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:127-148
────────────────────────────────────────────────────────────────────────────────
  127  ┌ resource "aws_instance" "web_server" {
  128  │   ami           = data.aws_ami.amazon_linux.id
  129  │   instance_type = "t2.micro" # Free tier eligible
  130  │   subnet_id     = aws_subnet.public_subnet.id
  131  │ 
  132  │   # Attach the Security Group we created above
  133  │   vpc_security_group_ids = [aws_security_group.web_sg.id]
  134  │ 
  135  └   # This script runs ONCE when the server boots up
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-enable-at-rest-encryption
      Impact The block device could be compromised and read from
  Resolution Turn on encryption for all block devices

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/enable-at-rest-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance#ebs-ephemeral-and-root-block-devices
────────────────────────────────────────────────────────────────────────────────


Result #6 HIGH Instance does not have storage encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-encrypt-instance-storage-data
      Impact Data can be read from RDS instances if compromised
  Resolution Enable encryption for RDS instances

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/encrypt-instance-storage-data/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance
────────────────────────────────────────────────────────────────────────────────


Result #7 HIGH Subnet associates public IP address. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:39
────────────────────────────────────────────────────────────────────────────────
   35    resource "aws_subnet" "public_subnet" {
   36      vpc_id                  = aws_vpc.main.id
   37      cidr_block              = "10.0.1.0/24" # Range: 10.0.1.0 - 10.0.1.255
   38      availability_zone       = "us-east-1a"  # We pin this to AZ 'a'
   39  [   map_public_ip_on_launch = true          # Auto-assign public IP (Make it public!) (true)
   40    
   41      tags = {
   42        Name = "My-Public-Subnet"
   43      }
   44    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-no-public-ip-subnet
      Impact The instance is publicly accessible
  Resolution Set the instance to not be publicly accessible

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/no-public-ip-subnet/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/subnet#map_public_ip_on_launch
────────────────────────────────────────────────────────────────────────────────


Result #8 MEDIUM VPC Flow Logs is not enabled for VPC  
────────────────────────────────────────────────────────────────────────────────
  main.tf:16-22
────────────────────────────────────────────────────────────────────────────────
   16    resource "aws_vpc" "main" {
   17      cidr_block = "10.0.0.0/16" # This gives you 65,536 IP addresses
   18    
   19      tags = {
   20        Name = "My-DevOps-Project-VPC"
   21      }
   22    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-require-vpc-flow-logs-for-all-vpcs
      Impact Without VPC flow logs, you risk not having enough information about network traffic flow to investigate incidents or identify security issues.
  Resolution Enable flow logs for VPC

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/require-vpc-flow-logs-for-all-vpcs/
────────────────────────────────────────────────────────────────────────────────


Result #9 MEDIUM Instance has very low backup retention period. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-specify-backup-retention
      Impact Potential loss of data and short opportunity for recovery
  Resolution Explicitly set the retention period to greater than the default

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/specify-backup-retention/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster#backup_retention_period
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#backup_retention_period
────────────────────────────────────────────────────────────────────────────────


Result #10 MEDIUM Instance does not have IAM Authentication enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
  Rego Package builtin.aws.rds.aws0176
     Rego Rule deny
────────────────────────────────────────────────────────────────────────────────


Result #11 MEDIUM Instance does not have Deletion Protection enabled 
────────────────────────────────────────────────────────────────────────────────
  main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
  Rego Package builtin.aws.rds.aws0177
     Rego Rule deny
────────────────────────────────────────────────────────────────────────────────


Result #12 LOW Security group rule does not have a description. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:102-107
────────────────────────────────────────────────────────────────────────────────
   78    resource "aws_security_group" "web_sg" {
   ..  
  102  ┌   egress {
  103  │     from_port   = 0
  104  │     to_port     = 0
  105  │     protocol    = "-1"
  106  │     cidr_blocks = ["0.0.0.0/0"]
  107  └   }
  ...  
  112    }
────────────────────────────────────────────────────────────────────────────────
          ID aws-ec2-add-description-to-security-group-rule
      Impact Descriptions provide context for the firewall rule reasons
  Resolution Add descriptions for all security groups rules

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/ec2/add-description-to-security-group-rule/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/security_group_rule
────────────────────────────────────────────────────────────────────────────────


Result #13 LOW Instance does not have performance insights enabled. 
────────────────────────────────────────────────────────────────────────────────
  main.tf:197-213
────────────────────────────────────────────────────────────────────────────────
  197  ┌ resource "aws_db_instance" "my_database" {
  198  │   allocated_storage      = 10
  199  │   db_name                = "mydb"
  200  │   engine                 = "mysql"
  201  │   engine_version         = "8.0"
  202  │   instance_class         = "db.t3.micro"
  203  │   username               = "admin"
  204  │   password               = var.db_password # Using the variable here
  205  └   parameter_group_name   = "default.mysql8.0"
  ...  
────────────────────────────────────────────────────────────────────────────────
          ID aws-rds-enable-performance-insights
      Impact Without adequate monitoring, performance related issues may go unreported and potentially lead to compromise.
  Resolution Enable performance insights

  More Information
  - https://aquasecurity.github.io/tfsec/v1.28.14/checks/aws/rds/enable-performance-insights/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster_instance#performance_insights_kms_key_id
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance#performance_insights_kms_key_id
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             225.608µs
  parsing              35.834173ms
  adaptation           860.806µs
  checks               115.08651ms
  total                152.007097ms

  counts
  ──────────────────────────────────────────
  modules downloaded   0
  modules processed    1
  blocks processed     17
  files read           2

  results
  ──────────────────────────────────────────
  passed               11
  ignored              0
  critical             3
  high                 4
  medium               4
  low                  2

  11 passed, 13 potential problem(s) detected.



Checkov.................................................................................Failed
- hook id: terraform_checkov
- exit code: 1

2026-01-28 19:38:54,677 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/vpc/aws:5.0.0 (for external modules, the --download-external-modules flag is required)
2026-01-28 19:38:54,679 [MainThread  ] [WARNI]  Failed to download module terraform-aws-modules/s3-bucket/aws:~> 3.0 (for external modules, the --download-external-modules flag is required)
terraform scan results:

Passed checks: 153, Failed checks: 101, Skipped checks: 0

Check: CKV_AWS_290: "Ensure IAM policies does not allow write access without constraints"
	FAILED for resource: aws_iam_role_policy.ec2_testing_access
	File: /03-infrastructure-as-code/code-labs/ci-cd-labs/web-app-project/iam.tf:76-99
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-290
Check: CKV_AWS_355: "Ensure no IAM policies documents allow "*" as a statement's resource for restrictable actions"
	FAILED for resource: aws_iam_role_policy.ec2_testing_access
	File: /03-infrastructure-as-code/code-labs/ci-cd-labs/web-app-project/iam.tf:76-99
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/bc-aws-355
Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: aws_dynamodb_table.terraform_locks
	File: /03-infrastructure-as-code/code-labs/ci-cd-labs/web-app-project/state_setup.tf:1-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6
Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: aws_dynamodb_table.terraform_locks
	File: /03-infrastructure-as-code/code-labs/ci-cd-labs/web-app-project/state_setup.tf:1-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52
Check: CKV_AWS_28: "Ensure DynamoDB point in time recovery (backup) is enabled"
	FAILED for resource: aws_dynamodb_table.terraform_locks
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:38-47
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-6
Check: CKV_AWS_119: "Ensure DynamoDB Tables are encrypted using a KMS Customer Managed CMK"
	FAILED for resource: aws_dynamodb_table.terraform_locks
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:38-47
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-52
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: module.my_ec2.aws_instance.this
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:24-34
	Calling File: /03-infrastructure-as-code/code-labs/terraform-labs/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: module.my_ec2.aws_instance.this
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:24-34
	Calling File: /03-infrastructure-as-code/code-labs/terraform-labs/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: module.my_ec2.aws_instance.this
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:24-34
	Calling File: /03-infrastructure-as-code/code-labs/terraform-labs/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: module.my_ec2.aws_instance.this
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:24-34
	Calling File: /03-infrastructure-as-code/code-labs/terraform-labs/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: module.my_ec2.aws_security_group.main
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:37-63
	Calling File: /03-infrastructure-as-code/code-labs/terraform-labs/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: module.my_ec2.aws_security_group.main
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:37-63
	Calling File: /03-infrastructure-as-code/code-labs/terraform-labs/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.allow_web
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:71-81
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.allow_web
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:71-81
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:82-89
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:82-89
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:82-89
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:82-89
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.first_instance
	File: /03-infrastructure-as-code/practice/main.tf:26-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.first_instance
	File: /03-infrastructure-as-code/practice/main.tf:26-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.first_instance
	File: /03-infrastructure-as-code/practice/main.tf:26-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13
Check: CKV_AWS_88: "EC2 instance should not have public IP."
	FAILED for resource: aws_instance.first_instance
	File: /03-infrastructure-as-code/practice/main.tf:26-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.allow_tls
	File: /03-infrastructure-as-code/practice/main.tf:69-103
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.allow_tls
	File: /03-infrastructure-as-code/practice/main.tf:69-103
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.allow_tls
	File: /03-infrastructure-as-code/practice/main.tf:69-103
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.allow_tls
	File: /03-infrastructure-as-code/practice/main.tf:69-103
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80
Check: CKV_AWS_26: "Ensure all data stored in the SNS topic is encrypted"
	FAILED for resource: aws_sns_topic.alerts
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/dashboard.tf:42-44
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-15
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.web_sg
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:38-65
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.web_sg
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:38-65
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.web_sg
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:38-65
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:83-94
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:83-94
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:83-94
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/terraform/main.tf:83-94
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13
Check: CKV_AWS_174: "Verify CloudFront Distribution Viewer Certificate is using TLS v1.2 or higher"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Calling File: /03-infrastructure-as-code/projects/static-website-project/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-63
Check: CKV_AWS_374: "Ensure AWS CloudFront web distribution has geo restriction enabled"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Calling File: /03-infrastructure-as-code/projects/static-website-project/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-374
Check: CKV_AWS_68: "CloudFront Distribution should have WAF enabled"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Calling File: /03-infrastructure-as-code/projects/static-website-project/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-27
Check: CKV_AWS_310: "Ensure CloudFront distributions should have origin failover configured"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Calling File: /03-infrastructure-as-code/projects/static-website-project/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-310
Check: CKV_AWS_86: "Ensure CloudFront distribution has Access Logging enabled"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Calling File: /03-infrastructure-as-code/projects/static-website-project/main.tf:1-7
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-20
Check: CKV_TF_1: "Ensure Terraform module sources use a commit hash"
	FAILED for resource: vpc
	File: /03-infrastructure-as-code/projects/vpc-infrastructure/main.tf:1-24
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.web_sg
	File: /04-deployment/terraform-aws-web/main.tf:16-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.web_sg
	File: /04-deployment/terraform-aws-web/main.tf:16-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.web_sg
	File: /04-deployment/terraform-aws-web/main.tf:16-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.web_sg
	File: /04-deployment/terraform-aws-web/main.tf:16-40
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.web_server
	File: /04-deployment/terraform-aws-web/main.tf:43-51
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.web_server
	File: /04-deployment/terraform-aws-web/main.tf:43-51
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.web_server
	File: /04-deployment/terraform-aws-web/main.tf:43-51
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.web_server
	File: /04-deployment/terraform-aws-web/main.tf:43-51
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13
Check: CKV_AWS_130: "Ensure VPC subnets do not assign public IP by default"
	FAILED for resource: aws_subnet.public_subnet
	File: /aws-terraform-project/main.tf:35-44
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-vpc-subnets-do-not-assign-public-ip-by-default
Check: CKV_AWS_23: "Ensure every security group and rule has a description"
	FAILED for resource: aws_security_group.web_sg
	File: /aws-terraform-project/main.tf:78-112
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-31
Check: CKV_AWS_382: "Ensure no security groups allow egress from 0.0.0.0:0 to port -1"
	FAILED for resource: aws_security_group.web_sg
	File: /aws-terraform-project/main.tf:78-112
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-382
Check: CKV_AWS_24: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 22"
	FAILED for resource: aws_security_group.web_sg
	File: /aws-terraform-project/main.tf:78-112
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-1-port-security
Check: CKV_AWS_260: "Ensure no security groups allow ingress from 0.0.0.0:0 to port 80"
	FAILED for resource: aws_security_group.web_sg
	File: /aws-terraform-project/main.tf:78-112
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-security-groups-do-not-allow-ingress-from-00000-to-port-80
Check: CKV_AWS_79: "Ensure Instance Metadata Service Version 1 is not enabled"
	FAILED for resource: aws_instance.web_server
	File: /aws-terraform-project/main.tf:127-148
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31
Check: CKV_AWS_135: "Ensure that EC2 is EBS optimized"
	FAILED for resource: aws_instance.web_server
	File: /aws-terraform-project/main.tf:127-148
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-ec2-is-ebs-optimized
Check: CKV_AWS_126: "Ensure that detailed monitoring is enabled for EC2 instances"
	FAILED for resource: aws_instance.web_server
	File: /aws-terraform-project/main.tf:127-148
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-detailed-monitoring-is-enabled-for-ec2-instances
Check: CKV_AWS_8: "Ensure all data stored in the Launch configuration or instance Elastic Blocks Store is securely encrypted"
	FAILED for resource: aws_instance.web_server
	File: /aws-terraform-project/main.tf:127-148
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-13
Check: CKV_AWS_161: "Ensure RDS database has IAM authentication enabled"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-rds-database-has-iam-authentication-enabled
Check: CKV_AWS_118: "Ensure that enhanced monitoring is enabled for Amazon RDS instances"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/ensure-that-enhanced-monitoring-is-enabled-for-amazon-rds-instances
Check: CKV_AWS_129: "Ensure that respective logs of Amazon Relational Database Service (Amazon RDS) are enabled"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-that-respective-logs-of-amazon-relational-database-service-amazon-rds-are-enabled
Check: CKV_AWS_226: "Ensure DB instance gets all minor upgrades automatically"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-aws-db-instance-gets-all-minor-upgrades-automatically
Check: CKV_AWS_293: "Ensure that AWS database instances have deletion protection enabled"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-293
Check: CKV_AWS_16: "Ensure all data stored in the RDS is securely encrypted at rest"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-4
Check: CKV_AWS_157: "Ensure that RDS instances have Multi-AZ enabled"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/general-73
Check: CKV2_AWS_5: "Ensure that Security Groups are attached to another resource"
	FAILED for resource: aws_security_group.allow_web
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:71-81
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-that-security-groups-are-attached-to-ec2-instances-or-elastic-network-interfaces-enis
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.practice
	File: /03-infrastructure-as-code/practice/main.tf:106-112
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging
Check: CKV2_AWS_11: "Ensure VPC flow logging is enabled in all VPCs"
	FAILED for resource: aws_vpc.main
	File: /aws-terraform-project/main.tf:16-22
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.terraform_state_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.my_practice_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/terraform-ci-cd/main.tf:17-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled
Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: module.my_static_website.aws_s3_bucket.static_website_bucket
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:2-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-bucket-has-cross-region-replication-enabled
Check: CKV2_AWS_42: "Ensure AWS CloudFront distribution uses custom SSL certificate"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/ensure-aws-cloudfront-distribution-uses-custom-ssl-certificate
Check: CKV2_AWS_60: "Ensure RDS instance with copy tags to snapshots is enabled"
	FAILED for resource: aws_db_instance.my_database
	File: /aws-terraform-project/main.tf:197-213
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-2-60
Check: CKV2_AWS_32: "Ensure CloudFront distribution has a response headers policy attached"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/bc-aws-networking-65
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.terraform_state_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.my_practice_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/terraform-ci-cd/main.tf:17-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62
Check: CKV2_AWS_62: "Ensure S3 buckets should have event notifications enabled"
	FAILED for resource: module.my_static_website.aws_s3_bucket.static_website_bucket
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:2-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-62
Check: CKV2_AWS_47: "Ensure AWS CloudFront attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability"
	FAILED for resource: module.my_static_website.aws_cloudfront_distribution.s3_distribution
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:80-130
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-47
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.terraform_state_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.my_practice_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/terraform-ci-cd/main.tf:17-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61
Check: CKV2_AWS_61: "Ensure that an S3 bucket has a lifecycle configuration"
	FAILED for resource: module.my_static_website.aws_s3_bucket.static_website_bucket
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:2-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/bc-aws-2-61
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.terraform_state_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.my_practice_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/terraform-ci-cd/main.tf:17-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging
Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: module.my_static_website.aws_s3_bucket.static_website_bucket
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:2-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.practice
	File: /03-infrastructure-as-code/practice/main.tf:106-112
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4
Check: CKV2_AWS_12: "Ensure the default security group of every VPC restricts all traffic"
	FAILED for resource: aws_vpc.main
	File: /aws-terraform-project/main.tf:16-22
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/networking-4
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: module.my_ec2.aws_instance.this
	File: /03-infrastructure-as-code/code-labs/terraform-labs/modules/module-1/main.tf:24-34
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.web_server
	File: /03-infrastructure-as-code/code-labs/terraform-testing-lab/main.tf:82-89
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.first_instance
	File: /03-infrastructure-as-code/practice/main.tf:26-66
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.web_server
	File: /04-deployment/terraform-aws-web/main.tf:43-51
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance
Check: CKV2_AWS_41: "Ensure an IAM role is attached to EC2 instance"
	FAILED for resource: aws_instance.web_server
	File: /aws-terraform-project/main.tf:127-148
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance
Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-networking-policies/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.terraform_state_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/backend-resources.tf:2-8
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.my_practice_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/terraform-ci-cd/main.tf:17-23
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default
Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: module.my_static_website.aws_s3_bucket.static_website_bucket
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:2-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/ensure-that-s3-buckets-are-encrypted-with-kms-by-default
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.my_bucket
	File: /03-infrastructure-as-code/code-labs/terraform-labs/tf-workspace-labs/main.tf:15-18
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning
Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: module.my_static_website.aws_s3_bucket.static_website_bucket
	File: /03-infrastructure-as-code/projects/static-website-project/modules/static-website/main.tf:2-10
	Guide: https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-16-enable-versioning
github_actions scan results:

Passed checks: 217, Failed checks: 3, Skipped checks: 0

Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Packer Build Golden AMI)
	File: /.github/workflows/packer-build.yml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Terraform Action)
	File: /.github/workflows/terraform.yml:0-1
Check: CKV2_GHA_1: "Ensure top-level permissions are not set to write-all"
	FAILED for resource: on(Multi-Stage Deployment)
	File: /.github/workflows/advanced-cicd.yml:64-65
ansible scan results:

Passed checks: 32, Failed checks: 2, Skipped checks: 0

Check: CKV2_ANSIBLE_3: "Ensure block is handling task errors properly"
	FAILED for resource: block.Final Cleanup Tasks
	File: /03-infrastructure-as-code/projects/golden-ami-pipeline/ansible/roles/common/tasks/main.yml:70-100
Check: CKV2_ANSIBLE_3: "Ensure block is handling task errors properly"
	FAILED for resource: block.Final Cleanup Tasks
	File: /03-infrastructure-as-code/code-labs/ansible-labs/ansible-projects/roles/common/tasks/main.yml:70-100
